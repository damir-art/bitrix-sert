# Технологии
https://academy.1c-bitrix.ru/education/?COURSE_ID=66&LESSON_ID=5885

Разные возможности системы:
- параметры модулей
- почтовые шаблоны и события
- агенты
- журнал событий

## Параметры модулей
Каждый модуль содержит настройки которые хранятся в отдельной таблице. Для получения или установки значений настроек модуля используется класс COption:
- GetOptionString()
- SetOptionString() - устанавливать также можно свои параметры со значениями
- GetOptionInt()
- SetOptionInt()

Пример, возвращаем адрес администратора из главного модуля:

    $email = COption::GetOptionString( 'main', 'email_from' );

## Почтовые шаблоны и типы почтовых событий
Почтовая система в Битрикс состоит из:
- почтовых событий и шаблонов
- API для откправки писем или помещения писем в очередь для отправки

Настройки > Настройки продукта > Почтовые события > Типы почтовых событий  
Тут располагается список событий,  
событие определяет набор переменных, которые доступны в шаблоне  
шаблоны привязаны к этому событию  
Шаблон содержит текст, переменные, данные получателя и отправителя

По умолчанию в системе каждый модуль создает свои типы событий и шаблоны, также можно создавать пользовательские.

## Агенты
Механизм для периодического запуска функций: отправка писем, очистка временных разделов, обновление валют и т.п. Вызывается в начале закгрузки страницы. Использует класс CAgent.

В админке агенты хранятся в: Настройки > Инструменты > Агенты  
Агенты есть от самой систему и агенты созданные разрабом.  
Агенты выполняются на хитах (при каждой загрузке страницы).  
У главного модуля есть специальная настройка сколько отсылать писем за 1 запуск агента.

Особенности программирования функций агента:
- возвращаемое значение это PHP-код, используемый при следующем запуске `return "agentFoo();";`
- не рекомендуется размещать ресурсоёмкие операции
- собственные функции агенты подключаем через файл `init.php` local/php_interface/include/agent.php
- в агентах не доступна переменная $USER, её необходимо создавать в агенте потом уничтожить (агенты исполняются до события onPageStart)
- запуск агента можно перенести с хитов на cron (ускоряет работу сайта)

## Журнал событий
- механизм который позволяет регистрировать различные события для последующего анализа
- например отслеживаться изменения в инфоблоке: создание, удаление, редактирование и т.д.
- возможно использвоать для фиксирования своих событий, API: `CEventLog::Add()`

Настройки > Инструменты > Журнал событий  
Настройки продукта > Настройки модулей > Главный модуль (можно настраивать события журнала)  
Также можно настраивать журналирование в инфоблоке

## Пример
Проверка товаров в каталоге, на отсутствие цены, запись в журнал и отправка письма администратору.
